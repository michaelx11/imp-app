<% provide(:title, "Schedule") %>
<div class="hero-unit">
    <h1>Schedule <small> cook, edit, or rsvp</small></h1>
</div>
<div class="row-fluid">

    <table class="display" id="meal-events-table">
        <thead>
            <tr>
                <th>Status</th>
                <th>Date</th>
                <th>Time</th>
                <th>MEAL</th>
                <th>Cook</th>
                <th>Helpers</th>
                <% if is_admin? %>
                    <th></th>
                    <th></th>
                    <th></th>
                <% end %>
                <% if signed_in? %>
                    <th></th>
                    <th></th>
                    <th></th>
                <% end %>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <% @meal_events.each do |meal_event| %>
                <tr>
                    <td> <%= status_text(meal_event) %> </td>
                    <td> <%= meal_event.date %> </td>
                    <td> <%= meal_event.time %> </td>
                    <td> <%= Meal.find_by_id(meal_event.meal).name %> </td>
                    <td> <%= User.find_by_id(meal_event.cook).name %> </td>
                    <td> <%= meal_event.helpers.to_a %> </td>
                    <% if is_admin? %>
                        <td> <%= meal_event.rsvps.to_a %> </td>
                        <td> <%= meal_event.latersvps.to_a %> </td>
                        <td> <%= meal_event.customers.to_a %> </td>
                    <% end %>
                    <% if signed_in? %>
                        <td> <%= link_to help_text(meal_event), edit_helper_path(meal_event) %> </td>
                        <td> <%= link_to rsvp_text(meal_event), edit_rsvp_path(meal_event) %> </td>
                        <td> <%= link_to late_rsvp_text(meal_event), edit_late_rsvp_path(meal_event) %> </td>
                    <% end %>
                    <% if current_user?(User.find_by_id(meal_event.cook)) || is_admin? %>
                        <td> <%= link_to 'Edit', edit_meal_event_path(meal_event) %> </td>
                        <td> <%= link_to 'Remove', meal_event, :method => :delete, :data => { :confirm => "Are you sure?" } %> </td>
                    <% else %>
                        <td></td>
                        <td></td>
                    <% end %>
                </tr>
            <% end %>
        </tbody>
    </table>
</div>

<script>
    $(document).ready(function() {
        $("#meal-events-table").dataTable();
    });

    $.extend( $.fn.dataTableExt.oStdClasses, {
        "sWrapper": "dataTables_wrapper form-inline"
    });
</script>
